#!/usr/bin/env sh

# Fetch the sources (will success even if they do not exist)
echo "================================================================================"
echo "==================================== FETCH ====================================="
echo "================================================================================"
abuild -c -K fetch
echo

# Create the source package
echo "================================================================================"
echo "=================================== SOURCE ====================================="
echo "================================================================================"
abuild -c -K srcpkg
echo

# Unpack the sources
echo "================================================================================"
echo "==================================== UNPACK ===================================="
echo "================================================================================"
abuild -c -K unpack
echo

# Build the project
echo "================================================================================"
echo "==================================== BUILD ====================================="
echo "================================================================================"
abuild -c -K build
echo

# Create the binary package
echo "================================================================================"
echo "=================================== BINARY ====================================="
echo "================================================================================"
abuild -c -K rootpkg
echo

# Execute whatever the arguments are
if [[ $# -ge 0 ]] && [[ "$@" != "" ]]; then
    exec "$@"
fi
